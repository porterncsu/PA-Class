---
title: "Online Shoppers Purchasing Intention Dataset"
output:
  html_document:
  pdf_document:
  html_notebook: default
---

The Online Shoppers Purchasing Intention dataset comes from the UCI Machine Learning Repository. Each row represents one online shopping session, with information about the pages visited (administrative, informational, and product-related), time spent on each page type, Google Analytics metrics (bounce rates, exit rates, page values), and session context (month, weekend, visitor type, operating system, browser, region, traffic source). The binary outcome variable `Revenue` indicates whether the session ended in a purchase. If Revenue = TRUE, the visitor made a purchase. If Revenue = FALSE, they did not.

This dataset is from the UCI Machine Learning Repository: <https://archive.ics.uci.edu/ml/datasets/Online+Shoppers+Purchasing+Intention+Dataset> and the Kaggle page: <https://www.kaggle.com/datasets/imakash3011/online-shoppers-purchasing-intention-dataset>.

```{r setup, message=FALSE, warning=FALSE, echo=FALSE}
knitr::opts_chunk$set(include = TRUE, echo = FALSE, warning = FALSE, message = FALSE, comment = NA)
# Packages used in this notebook
pkgs <- c("tidyverse", "skimr", "janitor", "gtsummary", "readr", "stringr", "purrr")
to_install <- pkgs[!pkgs %in% rownames(installed.packages())]
if (length(to_install)) install.packages(to_install, quiet = TRUE)
invisible(lapply(pkgs, library, character.only = TRUE))

theme_set(theme_minimal(base_size = 13))
```

Let's start by looking at the dimensions of the dataset.

```{r read-data}
# import .csv file
data <- read_csv("project_data_sets/online_shoppers/online_shoppers_intention.csv") %>%
  janitor::clean_names()

# print dimensions
tibble(
  rows = nrow(data),
  columns = ncol(data)
)
```

Let's take a look at the columns. Here I have inserted some descriptions from the documentation.

```{r}
tribble(
  ~variable,                  ~description,
  "administrative",           "Number of administrative pages visited (numeric)",
  "administrative_duration",  "Total time spent on administrative pages in seconds (numeric)",
  "informational",            "Number of informational pages visited (numeric)",
  "informational_duration",   "Total time spent on informational pages in seconds (numeric)",
  "product_related",          "Number of product-related pages visited (numeric)",
  "product_related_duration", "Total time spent on product-related pages in seconds (numeric)",
  "bounce_rates",             "Average bounce rate of pages visited (numeric)",
  "exit_rates",               "Average exit rate of pages visited (numeric)",
  "page_values",              "Average page value of pages visited (numeric)",
  "special_day",              "Closeness to a special day such as Valentine's Day (numeric, 0 to 1)",
  "month",                    "Month of the session (categorical)",
  "operating_systems",        "Operating system of the visitor (categorical, integer-coded)",
  "browser",                  "Browser used by the visitor (categorical, integer-coded)",
  "region",                   "Geographic region of the visitor (categorical, integer-coded)",
  "traffic_type",             "Traffic source type (categorical, integer-coded)",
  "visitor_type",             "Returning, new, or other visitor (categorical)",
  "weekend",                  "Whether the session occurred on a weekend (logical)",
  "revenue",                  "Target: whether the session ended in a purchase (TRUE/FALSE)"
) %>%
  knitr::kable(caption = "Online Shoppers: Variables Overview")
```

Let's examine the outcome: We see that about 15.5% of sessions ended in a purchase. This suggests a class imbalance that we may need to address in modeling. We will learn how to handle class imbalance in future classes.

```{r classprevalence}
data %>%
  count(revenue) %>%
  mutate(percent = round(n / sum(n) * 100, 1)) %>%
  knitr::kable(caption = "Distribution of outcome (revenue)")
```

And let's examine all the columns so that we understand what features are available to predict our outcome.

```{r data_glimpse_and_summary}
data %>%
  glimpse()

data %>%
  skimr::skim()
```

We see that this dataset includes a mix of numeric and categorical predictors. Several categorical variables (operating_systems, browser, region, traffic_type) are integer-coded but represent categories, not quantities. We will learn in class how you can extract more predictive information from the raw variables. This is referred to as "feature engineering."

## Summary and tips

When deciding whether to select this dataset for your project, consider the following:

-   **Prediction Goal**: The target variable is selected for you -- whether the session ended in a purchase (revenue = TRUE or FALSE). Consider what business or practical question you want to answer with this prediction.

-   **Scoping *Who* to Make Predictions For**: Each row represents a single browsing session, not a unique customer. You will want to think about whether your prediction task is about predicting purchase behavior for a session as it unfolds or identifying session characteristics that tend to lead to purchases.

-   **Class Imbalance**: The outcome variable is imbalanced, with only about 15.5% of sessions ending in a purchase. We will discuss strategies for handling class imbalance in modeling.

-   **Feature Engineering**: There are good opportunities for creative feature engineering. For example, you could create ratios (e.g., product-related pages as a proportion of total pages), combine page count and duration variables, or explore interactions between visitor type and browsing behavior. The integer-coded categorical variables (operating_systems, browser, region, traffic_type) will need to be treated as categories rather than numeric values. We will discuss feature engineering techniques in class.

-   **Missing Data**: This dataset is clean and does not have missing data.

-   **Google Analytics Metrics**: The bounce rate, exit rate, and page value variables come from Google Analytics. Understanding what these metrics mean in a web analytics context may help with interpretation and feature engineering.
